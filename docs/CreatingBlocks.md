# Creating blocks
The [PowBlockValidator.cs](../src/Mpb.Consensus/BlockLogic/PowBlockValidator.cs) class is responsible for generating Proof-of-Work [block](Models.md)s.
The class has only one core functionality: Creating a valid block and add it to the given chain. It is not possible to generate a block without adding it to the chain. The process is endless but can be stopped by calling the CancellationToken. The 'manager' of this process is [Miner.cs](../src/Mpb.Node/Miner.cs). The miner will calculate the current [difficulty](http://learnmeabitcoin.com/glossary/difficulty) and [target](http://learnmeabitcoin.com/glossary/target) and then creates the [coinbase transaction](http://learnmeabitcoin.com/glossary/coinbase-transaction) and grabs other transactions from the transaction pool prior to calling the block creator.

## The process
The _CreateValidBlockAndAddToChain_ method creates a new block object and sets the timestamp to the current UTC time. A merkleroot calculation over the given transactions is added to the block header to ensure closure and immutability. The previous block hash is retrieved from the given blockchain object by querying the last block in that chain. The given list of transactions are added and the new block object is crafted. Now the hashing process starts. The block creator will increment the nonce by 1, and tells [BlockFinalizer.cs](../src/Mpb.Consensus/BlockLogic/PowBlockFinalizer.cs) to generate a new SHA-256 hash of the block object. The block will be finalized by setting the hash and generating a signature (using the given private key). The block will be [validated](BlockValidation.md) by [PowBlockValidator.cs](../src/Mpb.Consensus/BlockLogic/PowBlockValidator.cs). When the validation passes, the validator will add the block to the chain automatically. Most of the times there are rejections, making the process repeat again by incrementing the nonce and generating a new hash and signature.

## Rejections
The process of building Proof-of-Work blocks is built on rejections (validation failures). Most of the times the block hash value is higher than the calculated target. The block creator will continue when the validation errors "Hash has no leading zero" or "Hash value is equal or higher than the current target" occurs. Other validation errors will be rethrown. The miner will catch all exceptions and then start the creation process again.